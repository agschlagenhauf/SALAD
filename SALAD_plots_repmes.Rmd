---
title: "SALAD plots according to tutorial"
author: "Lara Wieland"
date: "`r format(Sys.time(), '%d %B, %Y')`"
output:
  word_document: default
  html_document:
    df_print: paged
  pdf_document: default
fig_caption: yes
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Aggregated Data Import
```{r}
## NECESSARY TO RUN THIS FIRST
source('preps/data_import.R')

```

# Aggregated Data Prep
```{r, include=FALSE}
## NECESSARY TO RUN THIS FOR LATER RMANOVA ANALYSES (all markdowns in analyses folder)
source('preps/prep_agg.R')

```

# Aggregated Data Prep
```{r, include=FALSE}
## NECESSARY TO RUN THIS FOR LATER RMANOVA ANALYSES (all markdowns in analyses folder)
source('preps/longtowide_agg.R')

```

## Prettier plots according to Tutorial 'repmes_tutorial_R.Rmd': simple plots

```{r}
# first just the individual data points
f1 <- ggplot(data=longdat.correct, aes(y=p_correct)) +
  
   #Add geom_() objects
   geom_point(aes(x=order), color = "magenta", size = 1.5) +
   
   #Define additional settings
   scale_x_continuous(breaks=c(1,2), labels=c("Control", "Stress"), limits=c(0, 3)) +
   xlab("Condition") + ylab("Value") +
   ggtitle('Figure 1: Repeated measures individual datapoints') +
   theme_classic() 
   #coord_cartesian(ylim=c(y_lim_min, y_lim_max))

f1

# now with the datapoints connected (i.e., intra-individual trends).
f2 <- ggplot(data=longdat.winstay, aes(y=p_winstay)) +
  
   #Add geom_() objects
   geom_point(aes(x=volat2), color = "magenta", size = 1.5) +
   geom_line(aes(x=volat2, group=sub_id), color = 'lightgray') +
   
   #Define additional settings
   scale_x_continuous(breaks=c(1,2,3,4,5,6), labels=c("Control_pre","Control_rev","Control_post","Stress_pre", "Stress_rev", "Stress_post"), limits=c(0, 6)) +
   xlab("Condition") + ylab("Value") +
   ggtitle('Figure 2: Repeated measures with connecting lines') +
   theme_classic()
f2

```

## Prettier plots according to Tutorial 'repmes_tutorial_R.Rmd': Plots of raw data points (p_correct)

```{r}

longdat.correct$jvolat2 <- jitter(longdat.correct$volat2, amount=.09)
longdat.HC.correct$jvolat2 <- jitter(longdat.HC.correct$volat2, amount=.09)
longdat.AD.correct$jvolat2 <- jitter(longdat.AD.correct$volat2, amount=.09)

f3_pcorrect_HC <- ggplot(data=longdat.HC.correct, aes(y=p_correct)) +
  
   #Add geom_() objects
   geom_point(data = longdat.HC.correct %>% filter(cond2=="1"), aes(x=jvolat2), color = '#00BFC4', size = 1.5, 
              alpha = .6) +
      geom_point(data = longdat.HC.correct %>% filter(cond2=="0"), aes(x=jvolat2), color = '#F8766D', size = 1.5,
              alpha = .6) +

   geom_line(aes(x=jvolat2, group=sub_id), color = 'lightgray', alpha = .3) +
    
        geom_half_boxplot(
     data = longdat.HC.correct %>% filter(volat1=="pre_ST"), aes(x=jvolat2, y=p_correct), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#F8766D') +

      geom_half_boxplot(
     data = longdat.HC.correct %>% filter(volat1=="rev_ST"), aes(x=jvolat2, y=p_correct), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#F8766D') +

      geom_half_boxplot(
     data = longdat.HC.correct %>% filter(volat1=="post_ST"), aes(x=jvolat2, y=p_correct), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#F8766D') +
      
     geom_half_boxplot(
     data = longdat.HC.correct %>% filter(volat1=="pre_CT"), aes(x=jvolat2, y=p_correct), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#00BFC4') +

      geom_half_boxplot(
     data = longdat.HC.correct %>% filter(volat1=="rev_CT"), aes(x=jvolat2, y=p_correct), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#00BFC4') +

      geom_half_boxplot(
     data = longdat.HC.correct %>% filter(volat1=="post_CT"), aes(x=jvolat2, y=p_correct), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#00BFC4') +
   #Define additional settings
   scale_x_continuous(breaks=c(1,2,3,4,5,6), labels=c("Stress_pre", "Stress_rev", "Stress_post","Control_pre","Control_rev","Control_post")) +
   xlab("Condition") + ylab("Percentage of correct responses") +
   labs(title = 'Expected task effect: performance decreased in reversal phase', 
           subtitle = 'Condition by phase',
           caption = 'Datapoints are jittered') + 
   theme(plot.title = element_text(face = "italic"))
   theme_classic()
   
f3_pcorrect_HC


```

## Prettier plots according to Tutorial 'repmes_tutorial_R.Rmd': Plots of raw data points (p_correct)

```{r}


longdat.winstay$jvolat2 <- jitter(longdat.winstay$volat2, amount=.09)
longdat.lswitch$jvolat2 <- jitter(longdat.lswitch$volat2, amount=.09)
longdat.HC.winstay$jvolat2 <- jitter(longdat.HC.winstay$volat2, amount=.09)

f3_pwinstay_HC <- ggplot(data=longdat.HC.winstay, aes(y=p_winstay)) +
  
   #Add geom_() objects
   geom_point(data = longdat.HC.winstay %>% filter(cond2=="1"), aes(x=jvolat2), color = '#00BFC4', size = 1.5, 
              alpha = .6) +
      geom_point(data = longdat.HC.winstay %>% filter(cond2=="0"), aes(x=jvolat2), color = '#F8766D', size = 1.5,
              alpha = .6) +

   geom_line(aes(x=jvolat2, group=sub_id), color = 'lightgray', alpha = .3) +
    
        geom_half_boxplot(
     data = longdat.HC.winstay %>% filter(volat1=="pre_ST"), aes(x=jvolat2, y=p_winstay), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#F8766D') +

      geom_half_boxplot(
     data = longdat.HC.winstay %>% filter(volat1=="rev_ST"), aes(x=jvolat2, y=p_winstay), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#F8766D') +

      geom_half_boxplot(
     data = longdat.HC.winstay %>% filter(volat1=="post_ST"), aes(x=jvolat2, y=p_winstay), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#F8766D') +
      
     geom_half_boxplot(
     data = longdat.HC.winstay %>% filter(volat1=="pre_CT"), aes(x=jvolat2, y=p_winstay), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#00BFC4') +

      geom_half_boxplot(
     data = longdat.HC.winstay %>% filter(volat1=="rev_CT"), aes(x=jvolat2, y=p_winstay), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#00BFC4') +

      geom_half_boxplot(
     data = longdat.HC.winstay %>% filter(volat1=="post_CT"), aes(x=jvolat2, y=p_winstay), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#00BFC4') +
   
   scale_x_continuous(breaks=c(1,2,3,4,5,6), labels=c("Stress_pre", "Stress_rev", "Stress_post","Control_pre","Control_rev","Control_post")) +
   xlab("Condition") + ylab("Percentage of win-stay behavior") +
   labs(title = 'High proportion of win-stay behavior in all conditions and phases', 
           subtitle = 'Condition by phase',
           caption = 'Datapoints are jittered') + 
   theme(plot.title = element_text(face = "italic"))
   theme_classic()

f3_pwinstay_HC

```

```{r}

longdat.RT$jvolat2 <- jitter(longdat.RT$volat2, amount=.09)
longdat.RT$jvolat2 <- jitter(longdat.RT$volat2, amount=.09)
longdat.HC.RT$jvolat2 <- jitter(longdat.HC.RT$volat2, amount=.09)

f3_RT_HC <- ggplot(data=longdat.HC.RT, aes(y=p_RT)) +
  
   #Add geom_() objects
   geom_point(data = longdat.HC.RT %>% filter(cond2=="1"), aes(x=jvolat2), color = '#00BFC4', size = 1.5, 
              alpha = .6) +
      geom_point(data = longdat.HC.RT %>% filter(cond2=="0"), aes(x=jvolat2), color = '#F8766D', size = 1.5,
              alpha = .6) +

   geom_line(aes(x=jvolat2, group=sub_id), color = 'lightgray', alpha = .3) +
    
        geom_half_boxplot(
     data = longdat.HC.RT %>% filter(volat1=="pre_ST"), aes(x=jvolat2, y=p_RT), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#F8766D') +

      geom_half_boxplot(
     data = longdat.HC.RT %>% filter(volat1=="rev_ST"), aes(x=jvolat2, y=p_RT), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#F8766D') +

      geom_half_boxplot(
     data = longdat.HC.RT %>% filter(volat1=="post_ST"), aes(x=jvolat2, y=p_RT), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#F8766D') +
      
     geom_half_boxplot(
     data = longdat.HC.RT %>% filter(volat1=="pre_CT"), aes(x=jvolat2, y=p_RT), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#00BFC4') +

      geom_half_boxplot(
     data = longdat.HC.RT %>% filter(volat1=="rev_CT"), aes(x=jvolat2, y=p_RT), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#00BFC4') +

      geom_half_boxplot(
     data = longdat.HC.RT %>% filter(volat1=="post_CT"), aes(x=jvolat2, y=p_RT), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#00BFC4') +
   
   scale_x_continuous(breaks=c(1,2,3,4,5,6), labels=c("Stress_pre", "Stress_rev", "Stress_post","Control_pre","Control_rev","Control_post")) +
   xlab("Condition") + ylab("Reaction Time") +
   labs(title = 'High dispersion of reaction times in all phases', 
           subtitle = 'Condition by phase',
           caption = 'Datapoints are jittered') + 
   theme(plot.title = element_text(face = "italic"))
   theme_classic()

f3_RT_HC

```

## Prettier plots according to Tutorial 'repmes_tutorial_R.Rmd': Plots of raw data points (p_correct)

```{r}

longdat.lswitch$jvolat2 <- jitter(longdat.lswitch$volat2, amount=.09)
longdat.HC.lswitch$jvolat2 <- jitter(longdat.HC.lswitch$volat2, amount=.09)
longdat.AD.lswitch$jvolat2 <- jitter(longdat.AD.lswitch$volat2, amount=.09)

f3_lswitch_HC <- ggplot(data=longdat.HC.lswitch, aes(y=p_lswitch)) +
  
   #Add geom_() objects
   geom_point(data = longdat.HC.lswitch %>% filter(cond2=="1"), aes(x=jvolat2), color = '#00BFC4', size = 1.5, 
              alpha = .6) +
      geom_point(data = longdat.HC.lswitch %>% filter(cond2=="0"), aes(x=jvolat2), color = '#F8766D', size = 1.5,
              alpha = .6) +

   geom_line(aes(x=jvolat2, group=sub_id), color = 'lightgray', alpha = .3) +
    
        geom_half_boxplot(
     data = longdat.HC.lswitch %>% filter(volat1=="pre_ST"), aes(x=jvolat2, y = p_lswitch), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#F8766D') +

      geom_half_boxplot(
     data = longdat.HC.lswitch %>% filter(volat1=="rev_ST"), aes(x=jvolat2, y = p_lswitch), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#F8766D') +

      geom_half_boxplot(
     data = longdat.HC.lswitch %>% filter(volat1=="post_ST"), aes(x=jvolat2, y = p_lswitch), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#F8766D') +
      
     geom_half_boxplot(
     data = longdat.HC.lswitch %>% filter(volat1=="pre_CT"), aes(x=jvolat2, y = p_lswitch), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#00BFC4') +

      geom_half_boxplot(
     data = longdat.HC.lswitch %>% filter(volat1=="rev_CT"), aes(x=jvolat2, y = p_lswitch), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#00BFC4') +

      geom_half_boxplot(
     data = longdat.HC.lswitch %>% filter(volat1=="post_CT"), aes(x=jvolat2, y = p_lswitch), position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#00BFC4') +
   
   scale_x_continuous(breaks=c(1,2,3,4,5,6), labels=c("Stress_pre", "Stress_rev", "Stress_post","Control_pre","Control_rev","Control_post")) +
   xlab("Condition") + ylab("Percentage of lose-switch behavior") +
   labs(title = 'High dispersion of lose-switch behavior in all conditions and phases', 
           subtitle = 'Condition by phase',
           caption = 'Datapoints are jittered') + 
   theme(plot.title = element_text(face = "italic"))
   theme_classic()

f3_lswitch_HC


```

## Prettier plots according to Tutorial 'repmes_tutorial_R.Rmd': Plot for whole sample, not finished because not used

```{r}

# the same but with different meanings for colors, now blue is HC and orange is AD

f4 <- ggplot(data=longdat.correct, aes(y=p_correct)) +
  
   #Add geom_() objects
   geom_point(data = longdat.correct %>% filter(group=="AD"), aes(x=jvolat2), color = '#F8766D', size = 1.5, 
              alpha = .6) +
      geom_point(data = longdat.correct %>% filter(group == "HC"), aes(x=jvolat2), color = '#00BFC4', size = 1.5,
              alpha = .6) +

   geom_line(aes(x=jvolat2, group=sub_id), color = 'lightgray', alpha = .3) +
 
     geom_half_boxplot(
     data = longdat.correct %>% filter(group=="HC") %>% filter(volat1=="pre_ST"), aes(x=jvolat2, y = p_correct),  position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#00BFC4') +

      geom_half_boxplot(
     data = longdat.correct %>% filter(group=="AD") %>% filter(volat1=="pre_ST"), aes(x=jvolat2, y = p_correct), position = position_nudge(x = -.5),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#F8766D') +
   
      geom_half_boxplot(
     data = longdat.correct %>% filter(group=="HC") %>% filter(volat1=="rev_ST"), aes(x=jvolat2, y = p_correct) , position = position_nudge(x = -.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2, 
     fill = '#00BFC4') +
   
   #Define additional settings
   scale_x_continuous(breaks=c(1,2,3,4,5,6), labels=c("Stress_pre", "Stress_rev", "Stress_post","Control_pre","Control_rev","Control_post"), limits=c(0,6 )) +
   xlab("Condition") + ylab("Percentage of correct responses") +
   labs(title = 'Correct responses decreased in reversal phase', 
           subtitle = 'HC vs. AD condition by phase',
           caption = 'Datapoints are jittered') + 
   theme(plot.title = element_text(face = "italic"))
   theme_classic()

f4

```

## Prettier plots according to Tutorial 'repmes_tutorial_R.Rmd': Main plot for (non-)effect of stress

```{r}

mean_CT <- mean(data_all$p_correct_CT)
mean_ST <- mean(data_all$p_correct_ST)

median_CT <- median(data_all$p_correct_CT)
median_ST <- median(data_all$p_correct_ST)

sd_CT <- sd(data_all$p_correct_CT)
sd_ST <- sd(data_all$p_correct_ST)

ci_CT <- CI(data_all$p_correct_CT, ci = 0.95)
ci_ST <- CI(data_all$p_correct_ST, ci = 0.95)

score_mean <- c(mean_ST, mean_CT)
score_median <- c(median_CT, median_ST)
sd <- c(sd_CT, sd_ST)

ci <- c((ci_CT[1] - ci_CT[3]), (ci_ST[1] - ci_ST[3]))

summary_df <- data.frame(score_mean, score_median, sd, ci)

x_tick_means <- c(-0.1, 1.1)

f5_pcorrect_cond <- ggplot(data = longdat.correct, aes(y = p_correct)) +
  
   #Add geom_() objects
   geom_point(data = longdat.correct %>% filter(cond2=="1"), aes(x=cond2), color = '#00BFC4', size = 1.5, 
              alpha = .6) +
   geom_point(data = longdat.correct %>% filter(cond2=="0"), aes(x=cond2), color = '#F8766D', size = 1.5, 
              alpha = .6) +
   geom_line(aes(x = cond2, group = sub_id), color = 'lightgray', alpha = .3) +
  
   geom_half_boxplot(
     data = longdat.correct %>% filter(cond2=="1"), aes(x=cond2, y = p_correct), position = position_nudge(x = 0.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2,
     fill = '#00BFC4') +

   geom_half_boxplot(
     data = longdat.correct %>% filter(cond2=="0"), aes(x=cond2, y = p_correct), position = position_nudge(x = -0.3),
     side = "r",outlier.shape = NA, center = TRUE, errorbar.draw = FALSE, width = .2,
     fill = '#F8766D') +

   geom_half_violin(
     data = longdat.correct %>% filter(cond2=="1"),aes(x = cond2, y = p_correct), 
     position = position_nudge(x = 0.5), alpha = .6, side = "r", fill = '#00BFC4') +

   geom_half_violin(
     data = longdat.correct %>% filter(cond2=="0"),aes(x = cond2, y = p_correct), 
     position = position_nudge(x = 1.5), alpha = .6, side = "r", fill = "#F8766D") +

   geom_point(data = longdat.correct %>% filter(cond2=="1"), aes(x = cond2, y = score_mean[2]),
      position = position_nudge(x = 0.1), color = "#00BFC4", alpha = .6, size = 1.5) +

   geom_point(data = longdat.correct %>% filter(cond2=="0"), aes(x = cond2, y = score_mean[1]),
      position = position_nudge(x = -0.1), color = "#F8766D", alpha = .6, size = 1.5) +
   
   geom_errorbar(data = longdat.correct %>% filter(cond2=="1"), aes(x = cond2, y = score_mean[2],
      ymin = score_mean[1]-ci[1],
      ymax = score_mean[1]+ci[1]), 
      position = position_nudge(0.1), color = "#00BFC4", width = 0.05, size = 0.4, alpha = .5) +

   geom_errorbar(data = longdat.correct %>% filter(cond2=="0"), aes(x = cond2, y = score_mean[1],
      ymin = score_mean[2]-ci[2],
      ymax = score_mean[2]+ci[2]), 
      position = position_nudge(-0.1), color = "#F8766D", width = 0.05, size = 0.4, alpha = .5) +
   
   geom_line(data = summary_df, aes(x = x_tick_means, y = score_mean), color = 'gray', size = 1) +

   #Define additional settings
   
   scale_x_continuous(breaks=c(0,1), labels=c("Stress", "Control"), limits=c(-0.5,2)) +
   scale_y_continuous(limits=c(0,1.2)) +
   xlab("Condition") + ylab("Percentage of correct responses") +
   labs(title = 'ST vs. CT raw data and distributions', 
           caption = 'Datapoints are jittered') + 
    theme(
        panel.grid.major = element_line(colour = "#b7d8db"),
        panel.background = element_rect(fill = "transparent",colour = NA),
        plot.background = element_rect(fill = 'white'),
        )
   
f5_pcorrect_cond

```
